{"ast":null,"code":"import \"core-js/modules/es.json.stringify.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/web.url.js\";\nimport \"core-js/modules/web.url-search-params.js\";\nimport \"core-js/modules/es.parse-int.js\";\nimport axios from \"axios\";\nexport default {\n  name: \"ConfigView\",\n  data: function data() {\n    return {\n      config: {\n        dataset: \"\",\n        optimizer: \"\",\n        lr: 0,\n        test_batch_size: 0,\n        batch_size: 0,\n        epoch: 0,\n        seed: 0\n      },\n      dataset_data: {},\n      finished_epoch: 0,\n      roc: \"\",\n      acc: \"\",\n      timer: \"\"\n    };\n  },\n  methods: {\n    // 200\n    getData: function getData() {\n      var _this = this;\n\n      this.getDatasetName();\n      axios({\n        method: \"get\",\n        url: \"/train/\" + localStorage.uid + \"/\" + localStorage.pid + \"/\"\n      }).then(function (res) {\n        console.log(res);\n        console.log(res.data);\n\n        if (res.data.status == \"200\") {\n          _this.config.optimizer = res.data.optimizer;\n          _this.config.lr = res.data.lr;\n          _this.config.test_batch_size = res.data.test_batch_size;\n          _this.config.batch_size = res.data.batch_size;\n          _this.config.epoch = res.data.epoch;\n          _this.config.seed = res.data.seed;\n          _this.config.dataset = res.data.dataset_name;\n        } else if (res.data.status == \"204\") {\n          console.log(\"no config now\");\n        } else {\n          alert(\"config loading error!\");\n        }\n      });\n    },\n    // 200\n    getDatasetName: function getDatasetName() {\n      var _this2 = this;\n\n      axios({\n        method: \"get\",\n        url: \"/dataset/\" + localStorage.uid + \"/\"\n      }).then(function (res) {\n        console.log(res);\n\n        if (res.data.status == \"200\") {\n          _this2.dataset_data = res.data.dataset_detail;\n        } else {\n          alert(\"dataset loading error!\");\n        }\n      });\n    },\n    // 200\n    apply: function apply() {\n      var _this3 = this;\n\n      var form_data = new FormData();\n      form_data.append(\"config\", JSON.stringify(this.config));\n      axios({\n        method: \"post\",\n        url: \"/train/apply/\" + localStorage.uid + \"/\" + localStorage.pid + \"/\",\n        data: form_data,\n        headers: {\n          \"Content-Type\": \"multipart/form-data\"\n        }\n      }).then(function (res) {\n        console.log(res.data);\n\n        if (res.data.status == \"200\") {\n          console.log(\"apply ok!\");\n\n          _this3.getData();\n        } else {\n          console.log(\"apply fail!\");\n        }\n      });\n    },\n    getAcc: function getAcc() {\n      axios({\n        method: \"post\",\n        url: \"/train/acc/\" + localStorage.uid + \"/\" + localStorage.pid + \"/\",\n        responseType: \"blob\"\n      }).then(function (res) {\n        console.log(res);\n        console.log(res.data);\n\n        if (res.status == \"200\") {\n          console.log(\"acc 200\");\n          var dataInfo = res.data;\n          var reader = new window.FileReader();\n          reader.readAsArrayBuffer(dataInfo);\n\n          reader.onload = function (e) {\n            var result = e.target.result;\n            var contentType = dataInfo.type;\n            var blob = new Blob([result], {\n              type: \"image/png\"\n            });\n            var url = window.URL.createObjectURL(blob);\n            console.log(url);\n            this.acc = url;\n          };\n        } else {\n          alert(\"can not get acc!\");\n        }\n      });\n    },\n    getRoc: function getRoc() {\n      axios({\n        method: \"post\",\n        url: \"/train/roc/\" + localStorage.uid + \"/\" + localStorage.pid + \"/\",\n        responseType: \"blob\"\n      }).then(function (res) {\n        console.log(res);\n        console.log(res.data);\n\n        if (res.status == \"200\") {\n          console.log(\"roc 200\");\n          var dataInfo = res.data;\n          var reader = new window.FileReader();\n          reader.readAsArrayBuffer(dataInfo);\n\n          reader.onload = function (e) {\n            var result = e.target.result;\n            var contentType = dataInfo.type;\n            var blob = new Blob([result], {\n              type: contentType\n            });\n            var url = window.URL.createObjectURL(blob);\n            console.log(url);\n            this.roc = url;\n          };\n        } else {\n          alert(\"can not get roc!\");\n        }\n      });\n    },\n    getEpoch: function getEpoch() {\n      var _this4 = this;\n\n      axios({\n        method: \"post\",\n        url: \"/train/epoch/\" + localStorage.uid + \"/\" + localStorage.pid + \"/\"\n      }).then(function (res) {\n        console.log(res);\n        console.log(res.data);\n\n        if (res.status == \"200\") {\n          _this4.finished_epoch = parseInt(res.data.epoch);\n        } else {\n          alert(\"epoch error!\");\n        }\n      });\n    },\n    getTrainStatus: function getTrainStatus() {\n      console.log(\"enter get status\");\n      this.getAcc();\n      this.getRoc();\n      this.getEpoch(); // axios({\n      //   method: \"post\",\n      //   url: \"/train/status/\" + localStorage.uid + \"/\" + localStorage.pid + \"/\",\n      // }).then((res) => {\n      //   console.log(res);\n      //   console.log(res.data);\n      //   console.log(res.data.status);\n      //   console.log(res.data.epoch);\n      //   console.log(res.data.roc);\n      //   console.log(res.data.acc);\n      //   if (res.data.status == 200) {\n      //     console.log(\"zai status 200 le\");\n      //     this.train_status_data.finished_epoch = res.data.epoch;\n      //     this.train_status_data.roc = res.data.roc;\n      //     this.train_status_data.acc = res.data.acc;\n      //   } else {\n      //     alert(\"train error!\");\n      //   }\n      // });\n    },\n    // untested\n    run: function run() {\n      var _this5 = this;\n\n      var form_data = new FormData();\n      form_data.append(\"run\", \"true\");\n      axios({\n        method: \"post\",\n        url: \"/train/run/\" + localStorage.uid + \"/\" + localStorage.pid + \"/\",\n        data: form_data\n      }).then(function (res) {\n        console.log(res.data);\n\n        if (res.data.status == \"200\") {\n          console.log(\"zai run le...\");\n\n          _this5.getTrainStatus();\n\n          console.log(\"after get\"); // this.timer = setInterval(this.getTrainStatus(), 1000);\n        } else {\n          console.log(\"run fail!\");\n        }\n      });\n    }\n  },\n  mounted: function mounted() {\n    this.getData();\n  },\n  beforeDestroy: function beforeDestroy() {\n    clearTimeout(this.timer);\n  }\n};","map":{"version":3,"mappings":"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","names":["axios","name","data","config","dataset","optimizer","lr","test_batch_size","batch_size","epoch","seed","dataset_data","finished_epoch","roc","acc","timer","methods","getData","getDatasetName","method","url","localStorage","uid","pid","then","res","console","log","status","dataset_name","alert","dataset_detail","apply","form_data","FormData","append","JSON","stringify","headers","getAcc","responseType","dataInfo","reader","window","FileReader","readAsArrayBuffer","onload","e","result","target","contentType","type","blob","Blob","URL","createObjectURL","getRoc","getEpoch","parseInt","getTrainStatus","run","mounted","beforeDestroy","clearTimeout"],"sourceRoot":"","sources":["/root/Comp208-Neural-Lego/frontend/src/views/TrainView.vue"],"sourcesContent":["<template>\r\n  <body id=\"page-top\">\r\n    <!-- Page Wrapper -->\r\n    <div id=\"wrapper\">\r\n      <!-- Sidebar -->\r\n      <ul\r\n        class=\"navbar-nav bg-gradient-primary sidebar sidebar-dark accordion\"\r\n        id=\"accordionSidebar\"\r\n      >\r\n        <!-- Sidebar - Brand -->\r\n\r\n        <a\r\n          class=\"sidebar-brand d-flex align-items-center justify-content-center\"\r\n        >\r\n          <!-- <div class=\"sidebar-brand-icon rotate-n-15\">\r\n                    <i class=\"fas fa-laugh-wink\"></i>\r\n                </div> -->\r\n          <div class=\"sidebar-brand-text mx-3\">NEURAL LEGO</div>\r\n        </a>\r\n\r\n        <!-- Divider -->\r\n        <hr class=\"sidebar-divider my-0\" />\r\n\r\n        <!-- Nav Item - Dashboard -->\r\n        <li class=\"nav-item\">\r\n          <a class=\"nav-link\" href=\"/profile\">\r\n            <i class=\"fas fa-fw fa-user\"></i>\r\n            <span>User</span></a\r\n          >\r\n        </li>\r\n\r\n        <!-- Divider -->\r\n        <hr class=\"sidebar-divider my-0\" />\r\n\r\n        <!-- Nav Item - Dashboard -->\r\n        <li class=\"nav-item\">\r\n          <a class=\"nav-link\" href=\"/project\">\r\n            <i class=\"fas fa-fw fa-folder\"></i>\r\n            <span>Project</span></a\r\n          >\r\n        </li>\r\n\r\n        <li class=\"nav-item\">\r\n          <a class=\"nav-link\" href=\"/dataset\">\r\n            <i class=\"fas fa-fw fa-folder\"></i>\r\n            <span>Dataset</span></a\r\n          >\r\n        </li>\r\n\r\n        <!-- Divider -->\r\n        <hr class=\"sidebar-divider my-0\" />\r\n\r\n        <!-- Nav Item - Dashboard -->\r\n        <li class=\"nav-item\">\r\n          <a class=\"nav-link\" href=\"/template\">\r\n            <i class=\"fas fa-fw fa-table\"></i>\r\n            <span>Template</span></a\r\n          >\r\n        </li>\r\n\r\n        <hr class=\"sidebar-divider my-0\" />\r\n\r\n        <!-- Nav Item - Dashboard -->\r\n        <li class=\"nav-item active\">\r\n          <a class=\"nav-link\" href=\"/canvas\">\r\n            <i class=\"fas fa-fw fa-palette\"></i>\r\n            <span>Canvas</span></a\r\n          >\r\n        </li>\r\n\r\n        <hr class=\"sidebar-divider my-0\" />\r\n\r\n        <!-- Nav Item - Dashboard -->\r\n        <li class=\"nav-item\">\r\n          <a class=\"nav-link\" href=\"/welcome\">\r\n            <i class=\"fas fa-fw fa-arrow-circle-left\"></i>\r\n            <span>Log out</span></a\r\n          >\r\n        </li>\r\n\r\n        <!-- Divider -->\r\n        <hr class=\"sidebar-divider d-none d-md-block\" />\r\n      </ul>\r\n      <!-- End of Sidebar -->\r\n\r\n      <!-- Content Wrapper -->\r\n      <div id=\"content-wrapper\" class=\"d-flex flex-column\">\r\n        <!-- Main Content -->\r\n        <div id=\"content\">\r\n          <!-- Topbar -->\r\n          <nav\r\n            class=\"\r\n              navbar navbar-expand navbar-light\r\n              bg-white\r\n              topbar\r\n              mb-4\r\n              static-top\r\n              shadow\r\n            \"\r\n          >\r\n            <!-- Sidebar Toggle (Topbar) -->\r\n            <button\r\n              id=\"sidebarToggleTop\"\r\n              class=\"btn btn-link d-md-none rounded-circle mr-3\"\r\n            >\r\n              <i class=\"fa fa-bars\"></i>\r\n            </button>\r\n\r\n            <!-- Topbar Search -->\r\n            <form\r\n              class=\"\r\n                d-none d-sm-inline-block\r\n                form-inline\r\n                mr-auto\r\n                ml-md-3\r\n                my-2 my-md-0\r\n                mw-100\r\n                navbar-search\r\n              \"\r\n            >\r\n              <div class=\"input-group\">\r\n                <input\r\n                  type=\"text\"\r\n                  class=\"form-control bg-light border-0 small\"\r\n                  placeholder=\"Search for...\"\r\n                  aria-label=\"Search\"\r\n                  aria-describedby=\"basic-addon2\"\r\n                />\r\n                <div class=\"input-group-append\">\r\n                  <button class=\"btn btn-primary\" type=\"button\">\r\n                    <i class=\"fas fa-search fa-sm\"></i>\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </form>\r\n\r\n            <!-- Topbar Navbar -->\r\n            <ul class=\"navbar-nav ml-auto\">\r\n              <!-- Nav Item - Search Dropdown (Visible Only XS) -->\r\n              <li class=\"nav-item dropdown no-arrow d-sm-none\">\r\n                <a\r\n                  class=\"nav-link dropdown-toggle\"\r\n                  href=\"#\"\r\n                  id=\"searchDropdown\"\r\n                  role=\"button\"\r\n                  data-toggle=\"dropdown\"\r\n                  aria-haspopup=\"true\"\r\n                  aria-expanded=\"false\"\r\n                >\r\n                  <i class=\"fas fa-search fa-fw\"></i>\r\n                </a>\r\n                <!-- Dropdown - Messages -->\r\n                <div\r\n                  class=\"\r\n                    dropdown-menu dropdown-menu-right\r\n                    p-3\r\n                    shadow\r\n                    animated--grow-in\r\n                  \"\r\n                  aria-labelledby=\"searchDropdown\"\r\n                >\r\n                  <form class=\"form-inline mr-auto w-100 navbar-search\">\r\n                    <div class=\"input-group\">\r\n                      <input\r\n                        type=\"text\"\r\n                        class=\"form-control bg-light border-0 small\"\r\n                        placeholder=\"Search for...\"\r\n                        aria-label=\"Search\"\r\n                        aria-describedby=\"basic-addon2\"\r\n                      />\r\n                      <div class=\"input-group-append\">\r\n                        <button class=\"btn btn-primary\" type=\"button\">\r\n                          <i class=\"fas fa-search fa-sm\"></i>\r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n                  </form>\r\n                </div>\r\n              </li>\r\n            </ul>\r\n          </nav>\r\n          <!-- End of Topbar -->\r\n\r\n          <!-- Begin Page Content -->\r\n          <div class=\"container-fluid\">\r\n            <div class=\"row\">\r\n              <div class=\"col-xl-10 col-lg-5\">\r\n                <div class=\"card shadow mb-4\">\r\n                  <!-- Card Header - Dropdown -->\r\n                  <div\r\n                    class=\"\r\n                      card-header\r\n                      py-3\r\n                      d-flex\r\n                      flex-row\r\n                      align-items-center\r\n                      justify-content-between\r\n                    \"\r\n                  >\r\n                    <h6 class=\"m-0 font-weight-bold text-primary\">Setting</h6>\r\n                  </div>\r\n                  <!-- Sidebar -->\r\n                  <!-- <ul class=\"navbar-nav bg-gradient-primary sidebar sidebar-dark accordion\" id=\"accordionSidebar\"> -->\r\n                  <ul id=\"accordionSidebar\">\r\n                    <!-- Nav Item - Pages Collapse Menu -->\r\n                    <li class=\"nav-item\">\r\n                      <a\r\n                        class=\"nav-link collapsed\"\r\n                        href=\"#\"\r\n                        data-toggle=\"collapse\"\r\n                        data-target=\"#collapseTwo\"\r\n                        aria-expanded=\"true\"\r\n                        aria-controls=\"collapseTwo\"\r\n                      >\r\n                        <i class=\"fas fa-fw fa-cog\"></i>\r\n                        <span>Dataset</span>\r\n                      </a>\r\n                      <div\r\n                        id=\"collapseTwo\"\r\n                        class=\"collapse\"\r\n                        aria-labelledby=\"headingTwo\"\r\n                        data-parent=\"#accordionSidebar\"\r\n                      >\r\n                        <div class=\"form-group col-lg-2\">\r\n                          <label for=\"dataset\">select dataset:</label>\r\n                          <select\r\n                            v-model=\"config.dataset\"\r\n                            class=\"form-control\"\r\n                            id=\"dataset\"\r\n                          >\r\n                            <option\r\n                              v-for=\"ds in dataset_data\"\r\n                              :key=\"ds.id\"\r\n                              :label=\"ds.dataset_name\"\r\n                              :value=\"ds.dataset_name\"\r\n                            ></option>\r\n                          </select>\r\n                        </div>\r\n                      </div>\r\n                    </li>\r\n\r\n                    <!-- Nav Item - Pages Collapse Menu -->\r\n                    <li class=\"nav-item\">\r\n                      <a\r\n                        class=\"nav-link collapsed\"\r\n                        href=\"#\"\r\n                        data-toggle=\"collapse\"\r\n                        data-target=\"#collapseTwo\"\r\n                        aria-expanded=\"true\"\r\n                        aria-controls=\"collapseTwo\"\r\n                      >\r\n                        <i class=\"fas fa-fw fa-cog\"></i>\r\n                        <span>Optimizer</span>\r\n                      </a>\r\n                      <div\r\n                        id=\"collapseTwo\"\r\n                        class=\"collapse\"\r\n                        aria-labelledby=\"headingTwo\"\r\n                        data-parent=\"#accordionSidebar\"\r\n                      >\r\n                        <div class=\"form-group col-lg-2\">\r\n                          <label for=\"sel1\">select optimizer:</label>\r\n                          <select\r\n                            class=\"form-control\"\r\n                            id=\"sel1\"\r\n                            v-model=\"config.optimizer\"\r\n                          >\r\n                            <option value=\"Adam\">Adam</option>\r\n                            <option value=\"SGD\">SGD</option>\r\n                            <option value=\"Adagrad\">Adagrad</option>\r\n                          </select>\r\n                        </div>\r\n                      </div>\r\n                    </li>\r\n\r\n                    <!-- Nav Item - Pages Collapse Menu -->\r\n                    <li class=\"nav-item\">\r\n                      <a\r\n                        class=\"nav-link collapsed\"\r\n                        href=\"#\"\r\n                        data-toggle=\"collapse\"\r\n                        data-target=\"#collapsePages\"\r\n                        aria-expanded=\"true\"\r\n                        aria-controls=\"collapsePages\"\r\n                      >\r\n                        <i class=\"fas fa-fw fa-wrench\"></i>\r\n                        <span>Hyperparameters</span>\r\n                      </a>\r\n                      <div\r\n                        id=\"collapsePages\"\r\n                        class=\"collapse\"\r\n                        aria-labelledby=\"headingPages\"\r\n                        data-parent=\"#accordionSidebar\"\r\n                      >\r\n                        <div class=\"bg-white py-2 collapse-inner rounded\">\r\n                          <div class=\"form-group\">\r\n                            <div class=\"col-lg-2\">\r\n                              <label for=\"ex1\">learning rate</label>\r\n                              <input\r\n                                class=\"form-control input-sm\"\r\n                                id=\"ex1\"\r\n                                type=\"text\"\r\n                                v-model=\"config.lr\"\r\n                              />\r\n                            </div>\r\n                            <div class=\"col-lg-2\">\r\n                              <label for=\"ex2\">test batch size</label>\r\n                              <input\r\n                                class=\"form-control input-sm\"\r\n                                id=\"ex2\"\r\n                                type=\"text\"\r\n                                v-model=\"config.test_batch_size\"\r\n                              />\r\n                            </div>\r\n                            <div class=\"col-lg-2\">\r\n                              <label for=\"ex3\">batch size</label>\r\n                              <input\r\n                                class=\"form-control input-sm\"\r\n                                id=\"ex3\"\r\n                                type=\"text\"\r\n                                v-model=\"config.batch_size\"\r\n                              />\r\n                            </div>\r\n                            <div class=\"col-lg-2\">\r\n                              <label for=\"ex3\">epoch</label>\r\n                              <input\r\n                                class=\"form-control input-sm\"\r\n                                id=\"ex3\"\r\n                                type=\"text\"\r\n                                v-model=\"config.epoch\"\r\n                              />\r\n                            </div>\r\n                            <div class=\"col-lg-2\">\r\n                              <label for=\"ex3\">seed</label>\r\n                              <input\r\n                                class=\"form-control input-sm\"\r\n                                id=\"ex3\"\r\n                                type=\"text\"\r\n                                v-model=\"config.seed\"\r\n                              />\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </li>\r\n\r\n                    <li class=\"nav-item\">\r\n                      <a class=\"nav-link collapsed\">\r\n                        <button\r\n                          type=\"submit\"\r\n                          class=\"btn btn-primary\"\r\n                          @click=\"apply()\"\r\n                        >\r\n                          Apply\r\n                        </button>\r\n                      </a>\r\n\r\n                      <a class=\"nav-link collapsed\">\r\n                        <button\r\n                          type=\"submit\"\r\n                          class=\"btn btn-primary\"\r\n                          @click=\"run()\"\r\n                        >\r\n                          Run\r\n                        </button>\r\n                      </a>\r\n                      <!-- <button>Apply</button> -->\r\n                    </li>\r\n                  </ul>\r\n                  <!-- End of Sidebar -->\r\n                </div>\r\n              </div>\r\n\r\n              <div class=\"container-fluid\">\r\n                <div class=\"row\">\r\n                  <div class=\"col-xl-10 col-lg-5\">\r\n                    <div class=\"card shadow mb-4\">\r\n                      <!-- Card Header - Dropdown -->\r\n                      <div\r\n                        class=\"\r\n                          card-header\r\n                          py-3\r\n                          d-flex\r\n                          flex-row\r\n                          align-items-center\r\n                          justify-content-between\r\n                        \"\r\n                      >\r\n                        <h6 class=\"m-0 font-weight-bold text-primary\">\r\n                          progress\r\n                        </h6>\r\n\r\n                        <div class=\"col-xl-10 col-lg-5\">\r\n                          <!-- progress bar -->\r\n                          <div class=\"progress\">\r\n                          \r\n<div\r\n                              class=\"\r\n                                progress-bar\r\n                                progress-bar-striped\r\n                                progress-bar-animated\r\n                              \"\r\n                              role=\"progressbar\"\r\n                              :style=\"{width: finished_epoch + '%'}\"\r\n                              :aria-valuenow=\"finished_epoch\"\r\n                              aria-valuemin=\"0\"\r\n                              aria-valuemax=\"100\"\r\n                            >\r\n                              {{finished_epoch}}%\r\n                            </div>\r\n</div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              <!-- Area Chart -->\r\n              <div class=\"col-xl-5 col-lg-5\">\r\n                <div class=\"card shadow mb-4\">\r\n                  <!-- Card Header - Dropdown -->\r\n                  <div\r\n                    class=\"\r\n                      card-header\r\n                      py-3\r\n                      d-flex\r\n                      flex-row\r\n                      align-items-center\r\n                      justify-content-between\r\n                    \"\r\n                  >\r\n                    <h6 class=\"m-0 font-weight-bold text-primary\">\r\n                      Accuracy Curve\r\n                    </h6>\r\n                  </div>\r\n                  <!-- Card Body -->\r\n                  <div class=\"card-body\">\r\n                    <a href=\"#\"\r\n                      ><img\r\n                        class=\"card-img-top\"\r\n                        :src=\"this.acc\"\r\n                        alt=\"...\"\r\n                        /></a>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              <!-- Area Chart -->\r\n              <div class=\"col-xl-5 col-lg-5\">\r\n                <div class=\"card shadow mb-4\">\r\n                  <!-- Card Header - Dropdown -->\r\n                  <div\r\n                    class=\"\r\n                      card-header\r\n                      py-3\r\n                      d-flex\r\n                      flex-row\r\n                      align-items-center\r\n                      justify-content-between\r\n                    \"\r\n                  >\r\n                    <h6 class=\"m-0 font-weight-bold text-primary\">ROC Curve</h6>\r\n                  </div>\r\n                  <!-- Card Body -->\r\n                  <div class=\"card-body\">\r\n                    <a href=\"#\"\r\n                      ><img\r\n                        class=\"card-img-top\"\r\n                        :src=\"this.roc\"\r\n                        alt=\"...\"\r\n                    /></a>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <!-- End of Content Wrapper -->\r\n    </div>\r\n    <!-- End of Page Wrapper -->\r\n  </body>\r\n</template>\r\n\r\n<script>\r\nimport axios from \"axios\";\r\n\r\nexport default {\r\n  name: \"ConfigView\",\r\n  data() {\r\n    return {\r\n      config: {\r\n        dataset: \"\",\r\n        optimizer: \"\",\r\n        lr: 0,\r\n        test_batch_size: 0,\r\n        batch_size: 0,\r\n        epoch: 0,\r\n        seed: 0,\r\n      },\r\n\r\n      dataset_data: {},\r\n\r\n        finished_epoch: 0,\r\n        roc: \"\",\r\n        acc: \"\",\r\n\r\n      timer: \"\",\r\n    };\r\n  },\r\n\r\n  methods: {\r\n    // 200\r\n    getData() {\r\n      this.getDatasetName();\r\n\r\n      axios({\r\n        method: \"get\",\r\n        url: \"/train/\" + localStorage.uid + \"/\" + localStorage.pid + \"/\",\r\n      }).then((res) => {\r\n        console.log(res);\r\n        console.log(res.data);\r\n        if (res.data.status == \"200\") {\r\n          this.config.optimizer = res.data.optimizer;\r\n          this.config.lr = res.data.lr;\r\n          this.config.test_batch_size = res.data.test_batch_size;\r\n          this.config.batch_size = res.data.batch_size;\r\n          this.config.epoch = res.data.epoch;\r\n          this.config.seed = res.data.seed;\r\n          this.config.dataset = res.data.dataset_name;\r\n        } else if (res.data.status == \"204\") {\r\n          console.log(\"no config now\");\r\n        } else {\r\n          alert(\"config loading error!\");\r\n        }\r\n      });\r\n    },\r\n\r\n    // 200\r\n    getDatasetName() {\r\n      axios({\r\n        method: \"get\",\r\n        url: \"/dataset/\" + localStorage.uid + \"/\",\r\n      }).then((res) => {\r\n        console.log(res);\r\n        if (res.data.status == \"200\") {\r\n          this.dataset_data = res.data.dataset_detail;\r\n        } else {\r\n          alert(\"dataset loading error!\");\r\n        }\r\n      });\r\n    },\r\n\r\n    // 200\r\n    apply() {\r\n      var form_data = new FormData();\r\n      form_data.append(\"config\", JSON.stringify(this.config));\r\n      axios({\r\n        method: \"post\",\r\n        url: \"/train/apply/\" + localStorage.uid + \"/\" + localStorage.pid + \"/\",\r\n        data: form_data,\r\n        headers: { \"Content-Type\": \"multipart/form-data\" },\r\n      }).then((res) => {\r\n        console.log(res.data);\r\n        if (res.data.status == \"200\") {\r\n          console.log(\"apply ok!\");\r\n          this.getData();\r\n        } else {\r\n          console.log(\"apply fail!\");\r\n        }\r\n      });\r\n    },\r\n\r\n\r\ngetAcc() {\r\n      axios({\r\n        method: \"post\",\r\n        url: \"/train/acc/\" + localStorage.uid + \"/\" + localStorage.pid + \"/\",\r\n        responseType: \"blob\",\r\n      }).then((res) => {\r\n        console.log(res);\r\n        console.log(res.data);\r\n        if (res.status == \"200\") {\r\n          console.log(\"acc 200\");\r\n          const dataInfo = res.data;\r\n          let reader = new window.FileReader();\r\n          reader.readAsArrayBuffer(dataInfo);\r\n          reader.onload = function (e) {\r\n            const result = e.target.result;\r\n            const contentType = dataInfo.type;\r\n            const blob = new Blob([result], { type: \"image/png\" });\r\n            const url = window.URL.createObjectURL(blob);\r\n            console.log(url);\r\n            this.acc = url;\r\n          };\r\n        } else {\r\n          alert(\"can not get acc!\");\r\n        }\r\n      });\r\n    },\r\n\r\n    getRoc() {\r\n      axios({\r\n        method: \"post\",\r\n        url: \"/train/roc/\" + localStorage.uid + \"/\" + localStorage.pid + \"/\",\r\n        responseType: \"blob\",\r\n      }).then((res) => {\r\n        console.log(res);\r\n        console.log(res.data);\r\n\r\n        if (res.status == \"200\") {\r\n          console.log(\"roc 200\");\r\n          const dataInfo = res.data;\r\n          let reader = new window.FileReader();\r\n          reader.readAsArrayBuffer(dataInfo);\r\n          reader.onload = function (e) {\r\n            const result = e.target.result;\r\n            const contentType = dataInfo.type;\r\n            const blob = new Blob([result], { type: contentType });\r\n            const url = window.URL.createObjectURL(blob);\r\n            console.log(url);\r\n            this.roc = url;\r\n          };\r\n        } else {\r\n          alert(\"can not get roc!\");\r\n        }\r\n      });\r\n    },\r\n\r\n    getEpoch() {\r\n      axios({\r\n        method: \"post\",\r\n        url: \"/train/epoch/\" + localStorage.uid + \"/\" + localStorage.pid + \"/\",\r\n      }).then((res) => {\r\n        console.log(res);\r\n        console.log(res.data);\r\n        if (res.status == \"200\") {\r\n          this.finished_epoch = parseInt(res.data.epoch);\r\n        } else {\r\n          alert(\"epoch error!\");\r\n        }\r\n      });\r\n    },\r\n\r\n\r\n    getTrainStatus() {\r\n      console.log(\"enter get status\");\r\n      this.getAcc();\r\n      this.getRoc();\r\n      this.getEpoch();\r\n      // axios({\r\n      //   method: \"post\",\r\n      //   url: \"/train/status/\" + localStorage.uid + \"/\" + localStorage.pid + \"/\",\r\n      // }).then((res) => {\r\n      //   console.log(res);\r\n      //   console.log(res.data);\r\n      //   console.log(res.data.status);\r\n      //   console.log(res.data.epoch);\r\n      //   console.log(res.data.roc);\r\n      //   console.log(res.data.acc);\r\n      //   if (res.data.status == 200) {\r\n      //     console.log(\"zai status 200 le\");\r\n      //     this.train_status_data.finished_epoch = res.data.epoch;\r\n      //     this.train_status_data.roc = res.data.roc;\r\n      //     this.train_status_data.acc = res.data.acc;\r\n      //   } else {\r\n      //     alert(\"train error!\");\r\n      //   }\r\n      // });\r\n    },\r\n\r\n    // untested\r\n    run() {\r\n      var form_data = new FormData();\r\n      form_data.append(\"run\", \"true\");\r\n      axios({\r\n        method: \"post\",\r\n        url: \"/train/run/\" + localStorage.uid + \"/\" + localStorage.pid + \"/\",\r\n        data: form_data,\r\n      }).then((res) => {\r\n        console.log(res.data);\r\n        if (res.data.status == \"200\") {\r\n          console.log(\"zai run le...\");\r\n          this.getTrainStatus();          \r\n          console.log(\"after get\");\r\n// this.timer = setInterval(this.getTrainStatus(), 1000);\r\n        } else {\r\n          console.log(\"run fail!\");\r\n        }\r\n      });\r\n    },\r\n  },\r\n\r\n  mounted() {\r\n    this.getData();\r\n  },\r\n\r\n  beforeDestroy() {\r\n    clearTimeout(this.timer);\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.body {\r\n  position: fixed;\r\n  background-size: cover;\r\n  padding: 0;\r\n  margin: 0;\r\n  height: 100%;\r\n  width: 100%;\r\n}\r\n</style>\r\n<style scoped src=\"../../new_pages/vendor/fontawesome-free/css/all.min.css\"></style>\r\n<style scoped src=\"../../new_pages/css/sb-admin-2.min.css\"></style>\r\n"]},"metadata":{},"sourceType":"module"}